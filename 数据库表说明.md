以下是“设施蔬菜溯源系统”项目中各个数据表的**字段详细说明**，包括字段名称、数据类型、用途说明、是否主键/外键、与其他表的关系

---

## ✅ 1. `roles` 角色信息表

| 字段名           | 类型          | 说明                 | 主键/外键 |
| ------------- | ----------- | ------------------ | ----- |
| `id`          | INT         | 角色ID，自增主键          | 主键    |
| `name`        | VARCHAR(50) | 角色名称（如“管理员”、“生产者”） |       |
| `description` | TEXT        | 角色描述，用于备注说明        |       |

---

## ✅ 2. `users` 用户信息表（含登录账号）

| 字段名             | 类型           | 说明           | 主键/外键                 |
| --------------- | ------------ | ------------ | --------------------- |
| `id`            | INT          | 用户ID         | 主键                    |
| `username`      | VARCHAR(100) | 登录账号         | 唯一                    |
| `password`      | VARCHAR(200) | 加密后的密码       |                       |
| `tel`           | VARCHAR(20)  | 联系电话         |                       |
| `role_id`       | INT          | 用户所属角色（角色ID） | 外键 → `roles.id`       |
| `enterprise_id` | INT          | 用户所属企业（企业ID） | 外键 → `enterprises.id` |
| `create_time`   | DATETIME     | 注册时间         |                       |

---

## ✅ 3. `enterprises` 企业信息表

| 字段名        | 类型           | 说明     | 主键 |
| ---------- | ------------ | ------ | -- |
| `id`       | INT          | 企业ID   | 主键 |
| `name`     | VARCHAR(100) | 企业名称   |    |
| `contacts` | VARCHAR(100) | 法人或负责人 |    |
| `tel`      | VARCHAR(20)  | 联系电话   |    |
| `license`  | VARCHAR(50)  | 营业执照号  |    |
| `address`  | TEXT         | 地址     |    |

---

## ✅ 4. `products` 产品信息表（蔬菜品类）

| 字段名             | 类型             | 说明                          | 主键/外键           |
| --------------- | -------------- | --------------------------- | --------------- |
| `id`            | INT            | 产品ID                        | 主键              |
| `name`          | VARCHAR(100)   | 蔬菜名称（如“黄瓜”、“上海青”）           |                 |
| `image_url`     | VARCHAR(200)   | 产品主图URL                     |                 |
| `producer_id`   | INT            | 登记用户ID                      | 外键 → `users.id` |
| `origin`        | VARCHAR(200)   | 产地                          |                 |
| `planting_date` | DATE           | 种植日期                        |                 |
| `harvest_date`  | DATE           | 预计或实际采收日期                   |                 |
| `test_type`     | VARCHAR(100)   | 检测类型（如农残、重金属）               |                 |
| `test_date`     | DATE           | 检测时间                        |                 |
| `test_report`   | VARCHAR(200)   | 检测报告文件链接（图片或PDF）            |                 |
| `is_qualified`  | BOOLEAN 或 ENUM | 是否合格（true/false 或 “合格/不合格”） |                 |

---

## ✅ 5. `batches` 产品批次表

| 字段名           | 类型           | 说明                | 主键/外键              |
| ------------- | ------------ | ----------------- | ------------------ |
| `id`          | INT          | 批次ID              | 主键                 |
| `batch_code`  | VARCHAR(100) | 批次编号（如：202507001） | 唯一                 |
| `product_id`  | INT          | 所属产品ID            | 外键 → `products.id` |
| `create_time` | DATETIME     | 批次录入时间            |                    |
| `notes`       | TEXT         | 备注信息（可选）          |                    |

---

## ✅ 6. `environments` 生长环境记录表（多条/批次）

| 字段名           | 类型       | 说明          | 主键/外键             |
| ------------- | -------- | ----------- | ----------------- |
| `id`          | INT      | 主键          | 主键                |
| `batch_id`    | INT      | 所属批次ID      | 外键 → `batches.id` |
| `record_time` | DATETIME | 环境记录时间      |                   |
| `temperature` | FLOAT    | 温度（℃）       |                   |
| `humidity`    | FLOAT    | 湿度（%）       |                   |
| `light`       | INT      | 光照强度（lux）   |                   |
| `co2`         | FLOAT    | 二氧化碳浓度（ppm） |                   |
| `soil_ph`     | FLOAT    | 土壤pH值       |                   |
| `notes`       | TEXT     | 附加说明        |                   |

---

## ✅ 7. `actions` 农事操作记录表（多条/批次）

| 字段名           | 类型           | 说明              | 主键/外键             |
| ------------- | ------------ | --------------- | ----------------- |
| `id`          | INT          | 主键              | 主键                |
| `batch_id`    | INT          | 所属批次ID          | 外键 → `batches.id` |
| `action_type` | VARCHAR(100) | 操作类型，如播种、除草、施肥等 |                   |
| `description` | TEXT         | 操作详情说明          |                   |
| `image_url`   | VARCHAR(200) | 操作照片URL         |                   |
| `operator_id` | INT          | 操作者用户ID         | 外键 → `users.id`   |
| `record_time` | DATETIME     | 操作时间            |                   |

---

## ✅ 8. `qrcodes` 二维码信息表（扫码溯源核心）

| 字段名              | 类型           | 说明                   | 主键/外键              |
| ---------------- | ------------ | -------------------- | ------------------ |
| `id`             | INT          | 主键                   | 主键                 |
| `qrcode_id`      | VARCHAR(100) | 唯一二维码ID（作为扫码内容）      | 唯一                 |
| `batch_id`       | INT          | 所属批次ID               | 外键 → `batches.id`  |
| `product_id`     | INT          | 所属产品ID（便于快速查找）       | 外键 → `products.id` |
| `link`           | VARCHAR(200) | 二维码展示页面链接            |                    |
| `generate_time`  | DATETIME     | 二维码生成时间              |                    |
| `scan_count`     | INT          | 被扫码次数                |                    |
| `last_scan_time` | DATETIME     | 最近扫码时间               |                    |
| `status`         | TINYINT      | 二维码状态（0未绑定、1正常、2失效等） |                    |
| `expire_time`    | DATETIME     | 有效期（可选）              |                    |

---

## 🧩 表之间的主外键依赖关系总结

| 表名             | 外键字段                      | 依赖表                   |
| -------------- | ------------------------- | --------------------- |
| `users`        | `role_id`                 | `roles`               |
| `users`        | `enterprise_id`           | `enterprises`         |
| `products`     | `producer_id`             | `users`               |
| `batches`      | `product_id`              | `products`            |
| `environments` | `batch_id`                | `batches`             |
| `actions`      | `batch_id`, `operator_id` | `batches`, `users`    |
| `qrcodes`      | `batch_id`, `product_id`  | `batches`, `products` |

---
